{"version":3,"file":"readium-css.js","sourceRoot":"","sources":["../../../../../../src/electron/renderer/webview/readium-css.ts"],"names":[],"mappings":"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","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { ipcRenderer } from \"electron\";\n\nimport {\n    IEventPayload_R2_EVENT_READIUMCSS,\n    R2_EVENT_READIUMCSS,\n} from \"../../common/events\";\nimport {\n    READIUM2_ELECTRON_HTTP_PROTOCOL,\n    convertCustomSchemeToHttpUrl,\n} from \"../../common/sessions\";\nimport { IElectronWebviewTagWindow } from \"./state\";\nimport {\n    focusCssStyles,\n    readPosCssStyles,\n    scrollBarCssStyles,\n    selectionCssStyles,\n    targetCssStyles,\n} from \"./styles\";\n\nconst win = (global as any).window as IElectronWebviewTagWindow;\n\n// TODO DARK THEME\nconst CSS_CLASS_DARK_THEME = \"mdc-theme--dark\";\n\n// TODO: extract the const string \"readium-css\"\n// (also used in electron/main/readium-css.ts)\nlet origin = win.location.origin;\nif (origin.startsWith(READIUM2_ELECTRON_HTTP_PROTOCOL + \"://\")) {\n    origin = convertCustomSchemeToHttpUrl(win.location.href);\n    origin = origin.replace(/\\/pub\\/.*/, \"\");\n}\nconst urlRootReadiumCSS = origin + \"/readium-css/\";\nconsole.log(urlRootReadiumCSS);\n// const urlResizeSensor = win.location.origin + \"/resize-sensor.js\";\n\nexport const DEBUG_VISUALS = false;\n\nexport const configureFixedLayout = (isFixedLayout: boolean) => {\n    if (!win.document || !win.document.head || !win.document.body) {\n        return;\n    }\n\n    let width: number = win.READIUM2.fxlViewportWidth;\n    let height: number = win.READIUM2.fxlViewportHeight;\n\n    if (!width || !height) {\n        const metaViewport = win.document.head.querySelector(\"meta[name=viewport]\");\n        if (!metaViewport) {\n            console.log(\"configureFixedLayout NO meta[name=viewport]\");\n            return;\n        }\n        const attr = metaViewport.getAttribute(\"content\");\n        if (!attr) {\n            console.log(\"configureFixedLayout NO meta[name=viewport && content]\");\n            return;\n        }\n        const wMatch = attr.match(/\\s*width\\s*=\\s*([0-9]+)/);\n        if (wMatch && wMatch.length >= 2) {\n            try {\n                width = parseInt(wMatch[1], 10);\n            } catch (err) {\n                console.log(err);\n                // ignore\n            }\n        } else {\n            console.log(\"configureFixedLayout NO meta[name=viewport && content WIDTH]\");\n        }\n        const hMatch = attr.match(/\\s*height\\s*=\\s*([0-9]+)/);\n        if (hMatch && hMatch.length >= 2) {\n            try {\n                height = parseInt(hMatch[1], 10);\n            } catch (err) {\n                console.log(err);\n                // ignore\n            }\n        } else {\n            console.log(\"configureFixedLayout NO meta[name=viewport && content HEIGHT]\");\n        }\n\n        if (width && height) {\n            console.log(\"READIUM_FXL_VIEWPORT_WIDTH: \" + width);\n            console.log(\"READIUM_FXL_VIEWPORT_HEIGHT: \" + height);\n\n            win.READIUM2.fxlViewportWidth = width;\n            win.READIUM2.fxlViewportHeight = height;\n        }\n    }\n\n    if (width && height && isFixedLayout\n        && win.document && win.document.documentElement && win.document.body) {\n        win.document.documentElement.style.overflow = \"hidden\";\n\n        // Many FXL EPUBs lack the body dimensions (only viewport meta)\n        win.document.body.style.width = width + \"px\";\n        win.document.body.style.height = height + \"px\";\n        win.document.body.style.overflow = \"hidden\";\n        win.document.body.style.margin = \"0\"; // 8px by default!\n\n        console.log(\"FXL width: \" + width);\n        console.log(\"FXL height: \" + height);\n\n        const visibleWidth = win.innerWidth;\n        const visibleHeight = win.innerHeight;\n        console.log(\"FXL visible width: \" + visibleWidth);\n        console.log(\"FXL visible height: \" + visibleHeight);\n\n        const ratioX = visibleWidth / width;\n        const ratioY = visibleHeight / height;\n        const ratio = Math.min(ratioX, ratioY);\n\n        const tx = (visibleWidth - (width * ratio)) / 2;\n        const ty = (visibleHeight - (height * ratio)) / 2;\n        console.log(\"FXL trans X: \" + tx);\n        console.log(\"FXL trans Y: \" + ty);\n\n        win.document.documentElement.style.transformOrigin = \"0 0\";\n        win.document.documentElement.style.transform = `translateX(${tx}px) translateY(${ty}px) scale(${ratio})`;\n    }\n};\n\nexport const injectDefaultCSS = () => {\n    appendCSSInline(\"electron-selection\", selectionCssStyles);\n    appendCSSInline(\"electron-focus\", focusCssStyles);\n    appendCSSInline(\"electron-target\", targetCssStyles);\n    appendCSSInline(\"electron-scrollbars\", scrollBarCssStyles);\n};\n\nexport const injectReadPosCSS = () => {\n    if (!DEBUG_VISUALS) {\n        return;\n    }\n    appendCSSInline(\"electron-readPos\", readPosCssStyles);\n};\n\nlet _isVerticalWritingMode = false;\nexport function isVerticalWritingMode(): boolean {\n    return _isVerticalWritingMode;\n}\n\nlet _isRTL = false;\nexport function isRTL(): boolean {\n    return _isRTL;\n}\n\nexport const isPaginated = (): boolean => {\n    return win && win.document && win.document.documentElement &&\n        win.document.documentElement.classList.contains(\"readium-paginated\");\n};\n\nexport const calculateMaxScrollShift = (): number => {\n\n    if (!win || !win.document || !win.document.body || !win.document.documentElement) {\n        return 0;\n    }\n\n    const isPaged = isPaginated();\n\n    const maxScrollShift = isPaged ?\n        ((isVerticalWritingMode() ?\n            (win.document.body.scrollHeight - win.document.documentElement.offsetHeight) :\n            (win.document.body.scrollWidth - win.document.documentElement.offsetWidth))) :\n        ((isVerticalWritingMode() ?\n            (win.document.body.scrollWidth - win.document.documentElement.clientWidth) :\n            (win.document.body.scrollHeight - win.document.documentElement.clientHeight)));\n\n    return maxScrollShift;\n};\n\nexport const isTwoPageSpread = (): boolean => {\n\n    if (!win || !win.document || !win.document.documentElement) {\n        return false;\n    }\n\n    // const bodyStyle = win.getComputedStyle(win.document.body);\n    const docStyle = win.getComputedStyle(win.document.documentElement);\n\n    let docColumnCount: number | undefined;\n    // let docColumnGap: number | undefined;\n    if (docStyle) {\n        docColumnCount = parseInt(docStyle.getPropertyValue(\"column-count\"), 10);\n        // docColumnGap = parseInt(docStyle.getPropertyValue(\"column-gap\"), 10);\n    }\n\n    return docColumnCount === 2;\n};\nexport const calculateTotalColumns = (): number => {\n    if (!win || !win.document || !win.document.body || !isPaginated()) {\n        return 0;\n    }\n\n    let totalColumns = 0;\n    if (isVerticalWritingMode()) {\n        totalColumns = Math.ceil(win.document.body.offsetWidth / win.document.body.scrollWidth);\n    } else {\n        totalColumns = Math.ceil(win.document.body.offsetHeight / win.document.body.scrollHeight);\n    }\n    return totalColumns;\n};\nexport function calculateColumnDimension(): number {\n    if (!win.document || !win.document.documentElement || !win.document.body || !isPaginated()) {\n        return 0;\n    }\n\n    // win.document.body.offsetWidth + left/right margins === win.document.documentElement.offsetWidth\n    // margins non-zero in single page view\n\n    const isTwoPage = isTwoPageSpread();\n\n    let columnDimension = 0;\n    if (isVerticalWritingMode()) {\n        columnDimension = win.document.documentElement.offsetHeight;\n    } else {\n        columnDimension = (win.document.documentElement.offsetWidth * (isTwoPage ? 0.5 : 1));\n    }\n    return columnDimension;\n}\n\n// TODO? page-progression-direction\n// TODO? xml:lang ar, fa, he ==> RTL, ensure html@xml:lang and html@dir (if missing)\n// TODO? xml:lang zh, ja, ko ==> horizontal, ensure html@xml:lang (if missing)\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/readium-css/blob/develop/docs/CSS16-internationalization.md\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/readium-css/blob/develop/docs/CSS12-user_prefs.md#user-settings-can-be-language-specific\nfunction computeVerticalRTL() {\n\n    if (!win.document || !win.document.documentElement) {\n        return;\n    }\n\n    let dirAttr = win.document.documentElement.getAttribute(\"dir\");\n    if (dirAttr === \"rtl\") {\n        _isRTL = true;\n    }\n    if (!_isRTL && win.document.body) {\n        dirAttr = win.document.body.getAttribute(\"dir\");\n        if (dirAttr === \"rtl\") {\n            _isRTL = true;\n        }\n    }\n\n    const htmlStyle = win.getComputedStyle(win.document.documentElement);\n    if (htmlStyle) {\n        let prop = htmlStyle.getPropertyValue(\"writing-mode\");\n        if (!prop) {\n            prop = htmlStyle.getPropertyValue(\"-epub-writing-mode\");\n        }\n        if (prop && prop.indexOf(\"vertical\") >= 0) {\n            _isVerticalWritingMode = true;\n        }\n        if (prop && prop.indexOf(\"-rl\") > 0) {\n            _isRTL = true;\n        }\n        if (!_isRTL) {\n            prop = htmlStyle.getPropertyValue(\"direction\");\n            if (prop && prop.indexOf(\"rtl\") >= 0) {\n                _isRTL = true;\n            }\n        }\n    }\n    if ((!_isVerticalWritingMode || !_isRTL) && win.document.body) {\n        const bodyStyle = win.getComputedStyle(win.document.body);\n        if (bodyStyle) {\n            let prop: string;\n            if (!_isVerticalWritingMode) {\n                prop = bodyStyle.getPropertyValue(\"writing-mode\");\n                if (!prop) {\n                    prop = bodyStyle.getPropertyValue(\"-epub-writing-mode\");\n                }\n                if (prop && prop.indexOf(\"vertical\") >= 0) {\n                    _isVerticalWritingMode = true;\n                }\n                if (prop && prop.indexOf(\"-rl\") > 0) {\n                    _isRTL = true;\n                }\n            }\n            if (!_isRTL) {\n                prop = bodyStyle.getPropertyValue(\"direction\");\n                if (prop && prop.indexOf(\"rtl\") >= 0) {\n                    _isRTL = true;\n                }\n            }\n        }\n    }\n\n    console.log(\"_isVerticalWritingMode: \" + _isVerticalWritingMode);\n    console.log(\"_isRTL: \" + _isRTL);\n}\n\n// after DOMContentLoaded\nwin.addEventListener(\"load\", () => {\n    computeVerticalRTL();\n});\n\nconst ensureHead = () => {\n\n    if (!win.document || !win.document.documentElement) {\n        return;\n    }\n\n    const docElement = win.document.documentElement;\n\n    if (!win.document.head) {\n        const headElement = win.document.createElement(\"head\");\n        if (win.document.body) {\n            docElement.insertBefore(headElement, win.document.body);\n        } else {\n            docElement.appendChild(headElement);\n        }\n    }\n};\n\nipcRenderer.on(R2_EVENT_READIUMCSS, (_event: any, payload: IEventPayload_R2_EVENT_READIUMCSS) => {\n    readiumCSS(payload);\n});\n\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/readium-css/blob/develop/docs/CSS12-user_prefs.md\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/readium-css/blob/develop/docs/ReadiumCSS-user_variables.css\n// tslint:disable-next-line:max-line-length\n// https://github.com/readium/readium-css/blob/develop/docs/CSS19-api.md#user-settings\nfunction readiumCSSSet(messageJson: IEventPayload_R2_EVENT_READIUMCSS) {\n    if (!messageJson) {\n        return;\n    }\n\n    if (!win.document || !win.document.documentElement) {\n        return;\n    }\n\n    const docElement = win.document.documentElement;\n\n    if (!messageJson.setCSS) {\n\n        docElement.removeAttribute(\"data-readiumcss\");\n        removeAllCSS();\n        removeAllCSSInline();\n\n        if (messageJson.isFixedLayout) {\n            docElement.style.overflow = \"hidden\";\n        } else {\n            docElement.style.overflow = \"auto\";\n        }\n\n        const toRemove: string[] = [];\n        for (let i = 0; i < docElement.style.length; i++) {\n            const item = docElement.style.item(i);\n            if (item.indexOf(\"--USER__\") === 0) {\n                toRemove.push(item);\n            }\n        }\n        toRemove.forEach((item) => {\n            docElement.style.removeProperty(item);\n        });\n\n        docElement.classList.remove(CSS_CLASS_DARK_THEME);\n\n        return;\n    }\n\n    if (!docElement.hasAttribute(\"data-readiumcss\")) {\n        docElement.setAttribute(\"data-readiumcss\", \"yes\");\n\n        let needsDefaultCSS = true;\n        if (win.document.head && win.document.head.childElementCount) {\n            let elem = win.document.head.firstElementChild;\n            while (elem) {\n                if ((elem.localName && elem.localName.toLowerCase() === \"style\") ||\n                    (elem.getAttribute &&\n                        (elem.getAttribute(\"rel\") === \"stylesheet\" ||\n                            elem.getAttribute(\"type\") === \"text/css\" ||\n                            (elem.getAttribute(\"src\") &&\n                                (elem.getAttribute(\"src\") as string).endsWith(\".css\"))))) {\n                    needsDefaultCSS = false;\n                    break;\n                }\n                elem = elem.nextElementSibling;\n            }\n        }\n        if (needsDefaultCSS && win.document.body) {\n            const styleAttr = win.document.body.querySelector(\"*[style]\");\n            if (styleAttr) {\n                needsDefaultCSS = false;\n            }\n        }\n\n        const urlRoot = messageJson.urlRoot ?\n            messageJson.urlRoot + \"/readium-css/\" :\n            urlRootReadiumCSS;\n\n        appendCSS(\"before\", urlRoot);\n        if (needsDefaultCSS) {\n            appendCSS(\"default\", urlRoot);\n        }\n        appendCSS(\"after\", urlRoot);\n    }\n\n    const setCSS = messageJson.setCSS;\n\n    if (DEBUG_VISUALS) {\n        console.log(\"---- setCSS -----\");\n        console.log(setCSS);\n        console.log(\"-----\");\n    }\n\n    if (setCSS.night) {\n        // win.document.body\n        docElement.classList.add(CSS_CLASS_DARK_THEME);\n    } else {\n        // win.document.body\n        docElement.classList.remove(CSS_CLASS_DARK_THEME);\n    }\n\n    const needsAdvanced = true; // textAlign, bodyHyphens, fontSize, etc.\n\n    // readium-advanced-on | readium-advanced-off\n    docElement.style.setProperty(\"--USER__advancedSettings\",\n        needsAdvanced ? \"readium-advanced-on\" : \"readium-advanced-off\");\n\n    // readium-darken-on | readium-darken-off\n    if (typeof setCSS.darken === \"undefined\") {\n        docElement.style.removeProperty(\"--USER__darkenFilter\");\n    } else {\n        docElement.style.setProperty(\"--USER__darkenFilter\",\n            setCSS.darken ? \"readium-darken-on\" : \"readium-darken-off\");\n    }\n\n    // readium-invert-on | readium-invert-off\n    if (typeof setCSS.invert === \"undefined\") {\n        docElement.style.removeProperty(\"--USER__invertFilter\");\n    } else {\n        docElement.style.setProperty(\"--USER__invertFilter\",\n            setCSS.invert ? \"readium-invert-on\" : \"readium-invert-off\");\n    }\n\n    // readium-default-on | readium-sepia-on | readium-night-on\n    docElement.style.setProperty(\"--USER__appearance\",\n        setCSS.sepia ? \"readium-sepia-on\" :\n        (setCSS.night ? \"readium-night-on\" : \"readium-default-on\"));\n\n    // readium-paged-on | readium-scroll-on\n    docElement.style.setProperty(\"--USER__view\",\n        setCSS.paged ? \"readium-paged-on\" : \"readium-scroll-on\");\n    if (setCSS.paged) {\n        docElement.style.overflow = \"hidden\";\n        docElement.classList.add(\"readium-paginated\");\n    } else {\n        docElement.style.overflow = \"auto\";\n        docElement.classList.remove(\"readium-paginated\");\n    }\n\n    const defaultPublisherFont = !setCSS.font || setCSS.font === \"DEFAULT\";\n\n    const a11yNormalize = ((typeof setCSS.a11yNormalize !== \"undefined\") ?\n        (setCSS.a11yNormalize ? \"readium-a11y-on\" : \"readium-a11y-off\") :\n        \"readium-a11y-off\" // will remove, because undefined\n        );\n\n    const needsFontOverride = a11yNormalize === \"readium-a11y-on\" || !defaultPublisherFont;\n\n    // readium-font-on | readium-font-off\n    docElement.style.setProperty(\"--USER__fontOverride\",\n        needsFontOverride ? \"readium-font-on\" : \"readium-font-off\");\n\n    // readium-a11y-on | readium-a11y-off\n    if (typeof setCSS.a11yNormalize === \"undefined\") {\n        docElement.style.removeProperty(\"--USER__a11yNormalize\");\n    } else {\n        docElement.style.setProperty(\"--USER__a11yNormalize\", a11yNormalize);\n    }\n\n    if (defaultPublisherFont) {\n        docElement.style.removeProperty(\"--USER__fontFamily\");\n    } else {\n        const font = setCSS.font;\n        let fontValue = \"\";\n        if (font === \"DUO\" || font === \"IA Writer Duospace\") {\n            fontValue = \"IA Writer Duospace\";\n        } else if (font === \"DYS\" || font === \"AccessibleDfa\") {\n            fontValue = \"AccessibleDfa\";\n        } else if (font === \"OLD\" || font === \"oldStyleTf\") {\n            fontValue = \"var(--RS__oldStyleTf)\";\n        } else if (font === \"MODERN\" || font === \"modernTf\") {\n            fontValue = \"var(--RS__modernTf)\";\n        } else if (font === \"SANS\" || font === \"sansTf\") {\n            fontValue = \"var(--RS__sansTf)\";\n        } else if (font === \"HUMAN\" || font === \"humanistTf\") {\n            fontValue = \"var(--RS__humanistTf)\";\n        } else if (font === \"MONO\" || font === \"monospaceTf\") {\n            fontValue = \"var(--RS__monospaceTf)\";\n        } else if (font === \"JA\" || font === \"serif-ja\") {\n            fontValue = \"var(--RS__serif-ja)\";\n        } else if (font === \"JA-SANS\" || font === \"sans-serif-ja\") {\n            fontValue = \"var(--RS__sans-serif-ja)\";\n        } else if (font === \"JA-V\" || font === \"serif-ja-v\") {\n            fontValue = \"var(--RS__serif-ja-v)\";\n        } else if (font === \"JA-V-SANS\" || font === \"sans-serif-ja-v\") {\n            fontValue = \"var(--RS__sans-serif-ja-v)\";\n        } else if (typeof font === \"string\") {\n            fontValue = font;\n        }\n        if (fontValue) {\n            docElement.style.setProperty(\"--USER__fontFamily\", fontValue);\n        } else {\n            docElement.style.removeProperty(\"--USER__fontFamily\");\n        }\n    }\n\n    if (setCSS.fontSize) {\n        docElement.style.setProperty(\"--USER__fontSize\", setCSS.fontSize);\n    } else {\n        docElement.style.removeProperty(\"--USER__fontSize\");\n    }\n\n    if (setCSS.lineHeight) {\n        docElement.style.setProperty(\"--USER__lineHeight\", setCSS.lineHeight);\n    } else {\n        docElement.style.removeProperty(\"--USER__lineHeight\");\n    }\n\n    if (setCSS.typeScale) {\n        docElement.style.setProperty(\"--USER__typeScale\", setCSS.typeScale);\n    } else {\n        docElement.style.removeProperty(\"--USER__typeScale\");\n    }\n\n    if (setCSS.paraSpacing) {\n        docElement.style.setProperty(\"--USER__paraSpacing\", setCSS.paraSpacing);\n    } else {\n        docElement.style.removeProperty(\"--USER__paraSpacing\");\n    }\n\n    const isCJK = false; // TODO, lang tag?\n    if (_isVerticalWritingMode || (_isRTL || isCJK)) {\n        docElement.style.removeProperty(\"--USER__bodyHyphens\");\n\n        docElement.style.removeProperty(\"--USER__wordSpacing\");\n\n        docElement.style.removeProperty(\"--USER__letterSpacing\");\n\n        if (_isVerticalWritingMode || isCJK) {\n            if (_isVerticalWritingMode) {\n                docElement.style.removeProperty(\"--USER__colCount\");\n            }\n\n            docElement.style.removeProperty(\"--USER__paraIndent\");\n\n            docElement.style.removeProperty(\"--USER__textAlign\");\n\n        } else if (_isRTL) {\n            if (setCSS.ligatures) {\n                docElement.style.setProperty(\"--USER__ligatures\", setCSS.ligatures);\n            } else {\n                docElement.style.removeProperty(\"--USER__ligatures\");\n            }\n        }\n    } else {\n        if (setCSS.bodyHyphens) {\n            docElement.style.setProperty(\"--USER__bodyHyphens\", setCSS.bodyHyphens);\n        } else {\n            docElement.style.removeProperty(\"--USER__bodyHyphens\");\n        }\n\n        if (setCSS.wordSpacing) {\n            docElement.style.setProperty(\"--USER__wordSpacing\", setCSS.wordSpacing);\n        } else {\n            docElement.style.removeProperty(\"--USER__wordSpacing\");\n        }\n\n        if (setCSS.letterSpacing) {\n            docElement.style.setProperty(\"--USER__letterSpacing\", setCSS.letterSpacing);\n        } else {\n            docElement.style.removeProperty(\"--USER__letterSpacing\");\n        }\n\n        if (!_isVerticalWritingMode) {\n            if (setCSS.colCount) {\n                docElement.style.setProperty(\"--USER__colCount\", setCSS.colCount);\n            } else {\n                docElement.style.removeProperty(\"--USER__colCount\");\n            }\n\n            if (setCSS.paraIndent) {\n                docElement.style.setProperty(\"--USER__paraIndent\", setCSS.paraIndent);\n            } else {\n                docElement.style.removeProperty(\"--USER__paraIndent\");\n            }\n\n            if (setCSS.textAlign) {\n                docElement.style.setProperty(\"--USER__textAlign\", setCSS.textAlign);\n            } else {\n                docElement.style.removeProperty(\"--USER__textAlign\");\n            }\n        } else if (!_isRTL) {\n            docElement.style.removeProperty(\"--USER__ligatures\");\n        }\n    }\n\n    if (setCSS.pageMargins) {\n        docElement.style.setProperty(\"--USER__pageMargins\", setCSS.pageMargins);\n    } else {\n        docElement.style.removeProperty(\"--USER__pageMargins\");\n    }\n\n    if (setCSS.backgroundColor) {\n        docElement.style.setProperty(\"--USER__backgroundColor\", setCSS.backgroundColor);\n    } else {\n        docElement.style.removeProperty(\"--USER__backgroundColor\");\n    }\n    if (setCSS.textColor) {\n        docElement.style.setProperty(\"--USER__textColor\", setCSS.textColor);\n    } else {\n        docElement.style.removeProperty(\"--USER__textColor\");\n    }\n}\n\nexport const readiumCSS = (messageJson: IEventPayload_R2_EVENT_READIUMCSS) => {\n    readiumCSSSet(messageJson);\n};\n\nfunction appendCSSInline(id: string, css: string) {\n    ensureHead();\n\n    if (!win.document || !win.document.head) {\n        return;\n    }\n\n    const styleElement = win.document.createElement(\"style\");\n    styleElement.setAttribute(\"id\", \"Readium2-\" + id);\n    styleElement.setAttribute(\"type\", \"text/css\");\n    styleElement.appendChild(document.createTextNode(css));\n    win.document.head.appendChild(styleElement);\n}\n\n// unused (for now)\n// function removeCSSInline(id: string) {\n//     const styleElement = win.document.getElementById(\"Readium2-\" + id);\n//     if (styleElement && styleElement.parentNode) {\n//         styleElement.parentNode.removeChild(styleElement);\n//     }\n// }\n\nfunction appendCSS(mod: string, urlRoot: string) {\n    ensureHead();\n\n    if (!win.document || !win.document.head) {\n        return;\n    }\n\n    const linkElement = win.document.createElement(\"link\");\n    linkElement.setAttribute(\"id\", \"ReadiumCSS-\" + mod);\n    linkElement.setAttribute(\"rel\", \"stylesheet\");\n    linkElement.setAttribute(\"type\", \"text/css\");\n    linkElement.setAttribute(\"href\", urlRoot + \"ReadiumCSS-\" + mod + \".css\");\n    if (mod === \"before\" && win.document.head.childElementCount) {\n        win.document.head.insertBefore(linkElement, win.document.head.firstElementChild);\n    } else {\n        win.document.head.appendChild(linkElement);\n    }\n}\n\nfunction removeCSS(mod: string) {\n    const linkElement = win.document.getElementById(\"ReadiumCSS-\" + mod);\n    if (linkElement && linkElement.parentNode) {\n        linkElement.parentNode.removeChild(linkElement);\n    }\n}\n\nfunction removeAllCSSInline() {\n    // removeCSSInline(\"electron-selection\");\n    // removeCSSInline(\"electron-focus\");\n    // removeCSSInline(\"electron-scrollbars\");\n}\n\nfunction removeAllCSS() {\n    removeCSS(\"before\");\n    removeCSS(\"after\");\n    // removeCSS(\"base\");\n    // removeCSS(\"html5patch\");\n    // removeCSS(\"safeguards\");\n    removeCSS(\"default\");\n    // removeCSS(\"highlights\");\n    // removeCSS(\"scroll\");\n    // removeCSS(\"pagination\");\n    // removeCSS(\"night_mode\");\n    // removeCSS(\"pagination\");\n    // removeCSS(\"os_a11y\");\n    // removeCSS(\"user_settings\");\n    // removeCSS(\"fs_normalize\");\n}\n\n// // // https://javascript.info/size-and-scroll\n// export function debugCSSMetrics() {\n\n//     if (!win || !win.document || !win.document.documentElement || !win.document.body) {\n//         return;\n//     }\n\n//     // offsetW/H: excludes margin, includes border, scrollbar, padding.\n//     // clientW/H: excludes margin, border, scrollbar, includes padding.\n//     // scrollW/H: like client, but includes hidden (overflow) areas\n\n//     const bodyStyle = win.getComputedStyle(win.document.body);\n//     const docStyle = win.getComputedStyle(win.document.documentElement);\n\n//     console.log(\"--- XXXXX ---\");\n//     console.log(\"webview.innerWidth: \" + win.innerWidth);\n//     console.log(\"document.offsetWidth: \" + win.document.documentElement.offsetWidth);\n//     console.log(\"document.clientWidth: \" + win.document.documentElement.clientWidth);\n//     console.log(\"document.scrollWidth: \" + win.document.documentElement.scrollWidth);\n//     console.log(\"document.scrollLeft: \" + win.document.documentElement.scrollLeft);\n//     if (docStyle) {\n//         let propVal = docStyle.getPropertyValue(\"padding-left\");\n//         const docPaddingLeft = parseInt(propVal, 10);\n//         console.log(\"document.paddingLeft: \" + docPaddingLeft + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"padding-right\");\n//         const docPaddingRight = parseInt(propVal, 10);\n//         console.log(\"document.paddingRight: \" + docPaddingRight + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"margin-left\");\n//         const docMarginLeft = parseInt(propVal, 10);\n//         console.log(\"document.marginLeft: \" + docMarginLeft + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"margin-right\");\n//         const docMarginRight = parseInt(propVal, 10);\n//         console.log(\"document.marginRight: \" + docMarginRight + \" // \" + propVal);\n\n//         const docTotalWidth = win.document.documentElement.offsetWidth + docMarginLeft + docMarginRight;\n//         console.log(\"document.offsetWidth + margins: \" + docTotalWidth);\n//     }\n//     console.log(\"body.offsetWidth: \" + win.document.body.offsetWidth);\n//     console.log(\"body.clientWidth: \" + win.document.body.clientWidth);\n//     console.log(\"body.scrollWidth: \" + win.document.body.scrollWidth);\n//     console.log(\"body.scrollLeft: \" + win.document.body.scrollLeft);\n//     if (bodyStyle) {\n//         let propVal = bodyStyle.getPropertyValue(\"padding-left\");\n//         const bodyPaddingLeft = parseInt(bodyStyle.getPropertyValue(\"padding-left\"), 10);\n//         console.log(\"body.paddingLeft: \" + bodyPaddingLeft + \" // \" + propVal);\n\n//         propVal = bodyStyle.getPropertyValue(\"padding-right\");\n//         const bodyPaddingRight = parseInt(propVal, 10);\n//         console.log(\"body.paddingRight: \" + bodyPaddingRight + \" // \" + propVal);\n\n//         propVal = bodyStyle.getPropertyValue(\"margin-left\");\n//         const bodyMarginLeft = parseInt(propVal, 10);\n//         console.log(\"body.marginLeft: \" + bodyMarginLeft + \" // \" + propVal);\n\n//         propVal = bodyStyle.getPropertyValue(\"margin-right\");\n//         const bodyMarginRight = parseInt(propVal, 10);\n//         console.log(\"body.marginRight: \" + bodyMarginRight + \" // \" + propVal);\n\n//         const bodyTotalWidth = win.document.body.offsetWidth + bodyMarginLeft + bodyMarginRight;\n//         console.log(\"body.offsetWidth + margins: \" + bodyTotalWidth);\n\n//         console.log(\"--- X factor: \" + (win.document.documentElement.offsetWidth / bodyTotalWidth));\n//     }\n//     console.log(\"--- YYYYY ---\");\n//     console.log(\"webview.innerHeight: \" + win.innerHeight);\n//     console.log(\"document.offsetHeight: \" + win.document.documentElement.offsetHeight);\n//     console.log(\"document.clientHeight: \" + win.document.documentElement.clientHeight);\n//     console.log(\"document.scrollHeight: \" + win.document.documentElement.scrollHeight);\n//     console.log(\"document.scrollTop: \" + win.document.documentElement.scrollTop);\n//     if (docStyle) {\n//         let propVal = docStyle.getPropertyValue(\"padding-top\");\n//         const docPaddingTop = parseInt(propVal, 10);\n//         console.log(\"document.paddingTop: \" + docPaddingTop + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"padding-bottom\");\n//         const docPaddingBottom = parseInt(propVal, 10);\n//         console.log(\"document.paddingBottom: \" + docPaddingBottom + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"margin-top\");\n//         const docMarginTop = parseInt(propVal, 10);\n//         console.log(\"document.marginTop: \" + docMarginTop + \" // \" + propVal);\n\n//         propVal = docStyle.getPropertyValue(\"margin-bottom\");\n//         const docMarginBottom = parseInt(propVal, 10);\n//         console.log(\"document.marginBottom: \" + docMarginBottom + \" // \" + propVal);\n\n//         const docTotalHeight = win.document.documentElement.offsetHeight + docMarginTop + docMarginBottom;\n//         console.log(\"document.offsetHeight + margins: \" + docTotalHeight);\n//     }\n//     console.log(\"body.offsetHeight: \" + win.document.body.offsetHeight);\n//     console.log(\"body.clientHeight: \" + win.document.body.clientHeight);\n//     console.log(\"body.scrollHeight: \" + win.document.body.scrollHeight);\n//     console.log(\"body.scrollTop: \" + win.document.body.scrollTop);\n//     if (bodyStyle) {\n//         let propVal = bodyStyle.getPropertyValue(\"padding-top\");\n//         const bodyPaddingTop = parseInt(propVal, 10);\n//         console.log(\"body.paddingTop: \" + bodyPaddingTop);\n\n//         propVal = bodyStyle.getPropertyValue(\"padding-bottom\");\n//         const bodyPaddingBottom = parseInt(propVal, 10);\n//         console.log(\"body.paddingBottom: \" + bodyPaddingBottom);\n\n//         propVal = bodyStyle.getPropertyValue(\"margin-top\");\n//         const bodyMarginTop = parseInt(propVal, 10);\n//         console.log(\"body.marginTop: \" + bodyMarginTop);\n\n//         propVal = bodyStyle.getPropertyValue(\"margin-bottom\");\n//         const bodyMarginBottom = parseInt(propVal, 10);\n//         console.log(\"body.marginBottom: \" + bodyMarginBottom);\n\n//         const bodyTotalHeight = win.document.body.offsetHeight + bodyMarginTop + bodyMarginBottom;\n//         console.log(\"body.offsetHeight + margins: \" + bodyTotalHeight);\n\n//         console.log(\"--- Y factor: \" + (win.document.documentElement.offsetHeight / bodyTotalHeight));\n//     }\n//     console.log(\"---\");\n// }\n"]}