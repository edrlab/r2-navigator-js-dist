{"version":3,"file":"highlight.js","sourceRoot":"","sources":["../../../../../../src/electron/renderer/webview/highlight.ts"],"names":[],"mappings":"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","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport { debounce } from \"debounce\";\n\nimport { isPaginated } from \"../../common/readium-css-inject\";\nimport { ISelectionInfo } from \"../../common/selection\";\nimport { IRectSimple, getClientRectsNoOverlap } from \"../common/rect-utils\";\nimport { getScrollingElement } from \"./readium-css\";\nimport { convertRangeInfo } from \"./selection\";\nimport { IElectronWebviewTagWindow } from \"./state\";\n\n// import { isRTL } from './readium-css';\n\nexport const ID_HIGHLIGHTS_CONTAINER = \"R2_ID_HIGHLIGHTS_CONTAINER\";\nexport const CLASS_HIGHLIGHT_CONTAINER = \"R2_CLASS_HIGHLIGHT_CONTAINER\";\nexport const CLASS_HIGHLIGHT_AREA = \"R2_CLASS_HIGHLIGHT_AREA\";\nexport const CLASS_HIGHLIGHT_BOUNDING_AREA = \"R2_CLASS_HIGHLIGHT_BOUNDING_AREA\";\n\nexport interface IColor {\n    red: number;\n    green: number;\n    blue: number;\n}\n\nconst DEFAULT_BACKGROUND_COLOR_OPACITY = 0.1;\nconst ALT_BACKGROUND_COLOR_OPACITY = 0.4;\nconst DEFAULT_BACKGROUND_COLOR: IColor = {\n    blue: 100,\n    green: 50,\n    red: 230,\n};\n\ninterface IHighlight {\n    id: string;\n    selectionInfo: ISelectionInfo;\n    color: IColor;\n    pointerInteraction: boolean;\n}\n\nconst _highlights: IHighlight[] = [];\n\ninterface IHTMLDivElementWithRect extends HTMLDivElement {\n    rect: IRectSimple;\n    scale: number;\n    // xOffset: number;\n    // yOffset: number;\n}\n\nfunction resetHighlightBoundingStyle(_win: IElectronWebviewTagWindow, highlightBounding: HTMLElement) {\n\n    highlightBounding.style.outline = \"none\";\n    // tslint:disable-next-line:max-line-length\n    highlightBounding.style.setProperty(\"background-color\", \"transparent\", \"important\");\n}\n\n// tslint:disable-next-line:max-line-length\nfunction setHighlightBoundingStyle(_win: IElectronWebviewTagWindow, highlightBounding: HTMLElement, highlight: IHighlight) {\n\n    const opacity = ALT_BACKGROUND_COLOR_OPACITY;\n    // tslint:disable-next-line:max-line-length\n    highlightBounding.style.setProperty(\"background-color\", `rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, ${opacity})`, \"important\");\n\n    // tslint:disable-next-line:max-line-length\n    highlightBounding.style.outlineColor = `rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, 1)`;\n    highlightBounding.style.outlineStyle = \"solid\";\n    highlightBounding.style.outlineWidth = \"1px\";\n    highlightBounding.style.outlineOffset = \"0px\";\n}\n\nfunction resetHighlightAreaStyle(_win: IElectronWebviewTagWindow, highlightArea: HTMLElement) {\n\n    // if (!win.READIUM2.DEBUG_VISUALS) {\n    //     highlightArea.style.outline = \"none\";\n    // }\n\n    // tslint:disable-next-line:max-line-length\n    const id = (highlightArea.parentNode && highlightArea.parentNode.nodeType === Node.ELEMENT_NODE && (highlightArea.parentNode as Element).getAttribute) ?\n        (highlightArea.parentNode as Element).getAttribute(\"id\") : undefined;\n    if (id) {\n        const highlight = _highlights.find((h) => {\n            return h.id === id;\n        });\n        if (highlight) {\n            const opacity = DEFAULT_BACKGROUND_COLOR_OPACITY;\n            // tslint:disable-next-line:max-line-length\n            highlightArea.style.setProperty(\"background-color\", `rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, ${opacity})`, \"important\");\n        }\n    }\n}\n\nfunction setHighlightAreaStyle(_win: IElectronWebviewTagWindow, highlightAreas: Element[], highlight: IHighlight) {\n\n    for (const highlightArea of highlightAreas) {\n        const opacity = ALT_BACKGROUND_COLOR_OPACITY;\n        // tslint:disable-next-line:max-line-length\n        (highlightArea as HTMLElement).style.setProperty(\"background-color\", `rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, ${opacity})`, \"important\");\n\n        // if (!win.READIUM2.DEBUG_VISUALS) {\n        // tslint:disable-next-line:max-line-length\n        //     (highlightArea as HTMLElement).style.outlineColor = `rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, 1)`;\n        //     (highlightArea as HTMLElement).style.outlineStyle = \"solid\";\n        //     (highlightArea as HTMLElement).style.outlineWidth = \"1px\";\n        //     (highlightArea as HTMLElement).style.outlineOffset = \"0px\";\n        // }\n    }\n}\n\nfunction processMouseEvent(win: IElectronWebviewTagWindow, ev: MouseEvent) {\n    const documant = win.document;\n    const scrollElement = getScrollingElement(documant);\n\n    // relative to fixed window top-left corner\n    // (unlike pageX/Y which is relative to top-left rendered content area, subject to scrolling)\n    const x = ev.clientX;\n    const y = ev.clientY;\n\n    // const highlightsContainer = documant.getElementById(`${ID_HIGHLIGHTS_CONTAINER}`);\n    if (!_highlightsContainer) {\n        return;\n    }\n\n    const paginated = isPaginated(documant);\n    const bodyRect = documant.body.getBoundingClientRect();\n    const xOffset = paginated ? (-scrollElement.scrollLeft) : bodyRect.left;\n    const yOffset = paginated ? (-scrollElement.scrollTop) : bodyRect.top;\n\n    let foundHighlight: IHighlight | undefined;\n    let foundElement: IHTMLDivElementWithRect | undefined;\n    // for (const highlight of _highlights) {\n    for (let i = _highlights.length - 1; i >= 0; i--) {\n        const highlight = _highlights[i];\n\n        let highlightParent = documant.getElementById(`${highlight.id}`);\n        if (!highlightParent) { // ??!!\n            highlightParent = _highlightsContainer.querySelector(`#${highlight.id}`); // .${CLASS_HIGHLIGHT_CONTAINER}\n        }\n        if (!highlightParent) { // what?\n            continue;\n        }\n\n        let hit = false;\n        const highlightFragments = highlightParent.querySelectorAll(`.${CLASS_HIGHLIGHT_AREA}`);\n        for (const highlightFragment of highlightFragments) {\n            const withRect = highlightFragment as IHTMLDivElementWithRect;\n            // tslint:disable-next-line:max-line-length\n            // console.log(`RECT: ${withRect.rect.left} | ${withRect.rect.top} // ${withRect.rect.width} | ${withRect.rect.height}`);\n\n            const left = withRect.rect.left + xOffset; // (paginated ? withRect.xOffset : xOffset);\n            const top = withRect.rect.top + yOffset; // (paginated ? withRect.yOffset : yOffset);\n            if (x >= left &&\n                x < (left + withRect.rect.width) &&\n                y >= top &&\n                y < (top + withRect.rect.height)\n                ) {\n\n                hit = true;\n                break;\n            }\n        }\n        if (hit) {\n            foundHighlight = highlight;\n            foundElement = highlightParent as IHTMLDivElementWithRect;\n            break;\n        }\n\n        // hit = false;\n        // const highlightBounding = highlightParent.querySelector(`.${CLASS_HIGHLIGHT_BOUNDING_AREA}`);\n        // if (highlightBounding) {\n        //     const highlightBoundingWithRect = highlightBounding as IHTMLDivElementWithRect;\n\n        //     const left = highlightBoundingWithRect.rect.left + highlightBoundingWithRect.xOffset;\n        //     const top = highlightBoundingWithRect.rect.top + highlightBoundingWithRect.yOffset;\n        //     if (x >= left &&\n        //         x < (left + highlightBoundingWithRect.rect.width) &&\n        //         y >= top &&\n        //         y < (top + highlightBoundingWithRect.rect.height)\n        //         ) {\n\n        //         hit = true;\n        //     }\n        // }\n        // if (hit) {\n        //     foundHighlight = highlight;\n        //     foundElement = highlightParent as IHTMLDivElementWithRect;\n        //     break;\n        // }\n    }\n    if (!foundHighlight || !foundElement) {\n        const highlightBoundings = _highlightsContainer.querySelectorAll(`.${CLASS_HIGHLIGHT_BOUNDING_AREA}`);\n        for (const highlightBounding of highlightBoundings) {\n            resetHighlightBoundingStyle(win, highlightBounding as HTMLElement);\n        }\n        const allHighlightAreas = Array.from(_highlightsContainer.querySelectorAll(`.${CLASS_HIGHLIGHT_AREA}`));\n        for (const highlightArea of allHighlightAreas) {\n            resetHighlightAreaStyle(win, highlightArea as HTMLElement);\n        }\n        return;\n    }\n    if (foundElement.getAttribute(\"data-click\")) {\n        if (ev.type === \"mousemove\") {\n            // tslint:disable-next-line:max-line-length\n            const foundElementHighlightAreas = Array.from(foundElement.querySelectorAll(`.${CLASS_HIGHLIGHT_AREA}`));\n            const allHighlightAreas = _highlightsContainer.querySelectorAll(`.${CLASS_HIGHLIGHT_AREA}`);\n            for (const highlightArea of allHighlightAreas) {\n                if (foundElementHighlightAreas.indexOf(highlightArea) < 0) {\n                    resetHighlightAreaStyle(win, highlightArea as HTMLElement);\n                }\n            }\n            setHighlightAreaStyle(win, foundElementHighlightAreas, foundHighlight);\n\n            const foundElementHighlightBounding = foundElement.querySelector(`.${CLASS_HIGHLIGHT_BOUNDING_AREA}`);\n            const allHighlightBoundings = _highlightsContainer.querySelectorAll(`.${CLASS_HIGHLIGHT_BOUNDING_AREA}`);\n            for (const highlightBounding of allHighlightBoundings) {\n                if (!foundElementHighlightBounding || highlightBounding !== foundElementHighlightBounding) {\n                    resetHighlightBoundingStyle(win, highlightBounding as HTMLElement);\n                }\n            }\n            if (foundElementHighlightBounding) {\n                if (win.READIUM2.DEBUG_VISUALS) {\n                    setHighlightBoundingStyle(win, foundElementHighlightBounding as HTMLElement, foundHighlight);\n                }\n            }\n        } else if (ev.type === \"click\") {\n            console.log(\"HIGHLIGHT CLICK: \" + foundHighlight.id);\n            console.log(JSON.stringify(foundHighlight, null, \"  \"));\n        }\n    }\n}\n\nlet bodyEventListenersSet = false;\nlet _highlightsContainer: HTMLElement | null;\nfunction ensureHighlightsContainer(win: IElectronWebviewTagWindow): HTMLElement {\n    const documant = win.document;\n\n    if (!_highlightsContainer) {\n\n        if (!bodyEventListenersSet) {\n            bodyEventListenersSet = true;\n\n            // reminder: mouseenter/mouseleave do not bubble, so no event delegation\n            documant.body.addEventListener(\"click\", (ev: MouseEvent) => {\n                processMouseEvent(win, ev);\n            }, false);\n            documant.body.addEventListener(\"mousemove\", (ev: MouseEvent) => {\n                processMouseEvent(win, ev);\n            }, false);\n        }\n\n        _highlightsContainer = documant.createElement(\"div\");\n        _highlightsContainer.setAttribute(\"id\", ID_HIGHLIGHTS_CONTAINER);\n        _highlightsContainer.style.setProperty(\"pointer-events\", \"none\");\n        documant.body.append(_highlightsContainer);\n        // documant.documentElement.append(_highlightsContainer);\n    }\n    return _highlightsContainer;\n}\n\nexport function hideAllhighlights(_documant: Document) {\n    // for (const highlight of _highlights) {\n    //     const highlightContainer = documant.getElementById(highlight.id);\n    //     if (highlightContainer) {\n    //         highlightContainer.remove();\n    //     }\n    // }\n    if (_highlightsContainer) {\n        _highlightsContainer.remove();\n        _highlightsContainer = null;\n        // ensureHighlightsContainer(documant);\n    }\n}\n\nexport function destroyAllhighlights(documant: Document) {\n    // _highlights.forEach((highlight) => {\n    //     destroyHighlight(highlight.id);\n    // });\n    // for (const highlight of _highlights) {\n    //     destroyHighlight(highlight.id);\n    // }\n    // for (let i = _highlights.length - 1; i >= 0; i--) {\n    //     const highlight = _highlights[i];\n    //     destroyHighlight(highlight.id);\n    // }\n    hideAllhighlights(documant);\n    _highlights.splice(0, _highlights.length);\n}\n\nexport function destroyHighlight(documant: Document, id: string) {\n    let i = -1;\n    const highlight = _highlights.find((h, j) => {\n        i = j;\n        return h.id === id;\n    });\n    if (highlight && i >= 0 && i < _highlights.length) {\n        _highlights.splice(i, 1);\n    }\n\n    const highlightContainer = documant.getElementById(id);\n    if (highlightContainer) {\n        highlightContainer.remove();\n    }\n}\n\nexport function recreateAllHighlightsRaw(win: IElectronWebviewTagWindow) {\n    hideAllhighlights(win.document);\n    for (const highlight of _highlights) {\n        createHighlightDom(win, highlight);\n    }\n}\n\nexport const recreateAllHighlightsDebounced = debounce((win: IElectronWebviewTagWindow) => {\n    recreateAllHighlightsRaw(win);\n}, 500);\n\nexport function recreateAllHighlights(win: IElectronWebviewTagWindow) {\n    hideAllhighlights(win.document);\n    recreateAllHighlightsDebounced(win);\n}\n\nexport function createHighlight(\n    win: IElectronWebviewTagWindow,\n    selectionInfo: ISelectionInfo,\n    color: IColor | undefined,\n    pointerInteraction: boolean): string {\n\n    // tslint:disable-next-line:no-string-literal\n    // console.log(\"Chromium: \" + process.versions[\"chrome\"]);\n\n    // const unique = new Buffer(JSON.stringify(selectionInfo.rangeInfo, null, \"\")).toString(\"base64\");\n    // tslint:disable-next-line:max-line-length\n    const unique = new Buffer(`${selectionInfo.rangeInfo.cfi}${selectionInfo.rangeInfo.startContainerElementCssSelector}${selectionInfo.rangeInfo.startContainerChildTextNodeIndex}${selectionInfo.rangeInfo.startOffset}${selectionInfo.rangeInfo.endContainerElementCssSelector}${selectionInfo.rangeInfo.endContainerChildTextNodeIndex}${selectionInfo.rangeInfo.endOffset}`).toString(\"base64\");\n    const id = \"R2_HIGHLIGHT_\" + unique.replace(/\\+/, \"_\").replace(/=/, \"-\").replace(/\\//, \".\");\n\n    destroyHighlight(win.document, id);\n\n    const highlight: IHighlight = {\n        color: color ? color : DEFAULT_BACKGROUND_COLOR,\n        id,\n        pointerInteraction,\n        selectionInfo,\n    };\n    _highlights.push(highlight);\n\n    createHighlightDom(win, highlight);\n\n    return id;\n}\n\nfunction createHighlightDom(win: IElectronWebviewTagWindow, highlight: IHighlight): HTMLDivElement | undefined {\n\n    const documant = win.document;\n    const scrollElement = getScrollingElement(documant);\n\n    const range = convertRangeInfo(documant, highlight.selectionInfo.rangeInfo);\n    if (!range) {\n        return undefined;\n    }\n\n    const paginated = isPaginated(documant);\n    // const rtl = isRTL();\n\n    // checkRangeFix(documant);\n\n    const highlightsContainer = ensureHighlightsContainer(win);\n\n    const highlightParent = documant.createElement(\"div\") as IHTMLDivElementWithRect;\n    highlightParent.setAttribute(\"id\", highlight.id);\n    highlightParent.setAttribute(\"class\", CLASS_HIGHLIGHT_CONTAINER);\n    highlightParent.style.setProperty(\"pointer-events\", \"none\");\n    if (highlight.pointerInteraction) {\n        highlightParent.setAttribute(\"data-click\", \"1\");\n    }\n\n    // Resize Sensor sets body position to \"relative\" (default static),\n    // which may breaks things!\n    // (e.g. highlights CSS absolute/fixed positioning)\n    // Also note that ReadiumCSS default to (via stylesheet :root):\n    // documant.documentElement.style.position = \"relative\";\n    documant.body.style.position = \"relative\";\n    // documant.body.style.setProperty(\"position\", \"relative !important\");\n\n    // const docStyle = (documant.defaultView as Window).getComputedStyle(documant.documentElement);\n    // const bodyStyle = (documant.defaultView as Window).getComputedStyle(documant.body);\n    // const marginLeft = bodyStyle.getPropertyValue(\"margin-left\");\n    // console.log(\"marginLeft: \" + marginLeft);\n    // const marginTop = bodyStyle.getPropertyValue(\"margin-top\");\n    // console.log(\"marginTop: \" + marginTop);\n\n    const bodyRect = documant.body.getBoundingClientRect();\n    // console.log(\"==== bodyRect:\");\n    // console.log(\"width: \" + bodyRect.width);\n    // console.log(\"height: \" + bodyRect.height);\n    // console.log(\"top: \" + bodyRect.top);\n    // console.log(\"bottom: \" + bodyRect.bottom);\n    // console.log(\"left: \" + bodyRect.left);\n    // console.log(\"right: \" + bodyRect.right);\n\n    // const xOffset = paginated ? (bodyRect.left - parseInt(marginLeft, 10)) : bodyRect.left;\n    // const yOffset = paginated ? (bodyRect.top - parseInt(marginTop, 10)) : bodyRect.top;\n\n    const xOffset = paginated ? (-scrollElement.scrollLeft) : bodyRect.left;\n    const yOffset = paginated ? (-scrollElement.scrollTop) : bodyRect.top;\n\n    const scale = 1 / ((win.READIUM2 && win.READIUM2.isFixedLayout) ? win.READIUM2.fxlViewportScale : 1);\n\n    // console.log(\"scrollElement.scrollLeft: \" + scrollElement.scrollLeft);\n    // console.log(\"scrollElement.scrollTop: \" + scrollElement.scrollTop);\n\n    // const clientRects = range.getClientRects(); // ClientRectList | DOMRectList\n    const clientRects = win.READIUM2.DEBUG_VISUALS ? range.getClientRects() : getClientRectsNoOverlap(range);\n\n    for (const clientRect of clientRects) {\n        const highlightArea = documant.createElement(\"div\") as IHTMLDivElementWithRect;\n        highlightArea.setAttribute(\"class\", CLASS_HIGHLIGHT_AREA);\n\n        let extra = \"\";\n        if (win.READIUM2.DEBUG_VISUALS) {\n            const rgb = Math.round(0xffffff * Math.random());\n            // tslint:disable-next-line:no-bitwise\n            const r = rgb >> 16;\n            // tslint:disable-next-line:no-bitwise\n            const g = rgb >> 8 & 255;\n            // tslint:disable-next-line:no-bitwise\n            const b = rgb & 255;\n            // tslint:disable-next-line:max-line-length\n            extra = `outline-color: rgb(${r}, ${g}, ${b}); outline-style: solid; outline-width: 1px; outline-offset: -1px;`;\n            // box-shadow: inset 0 0 0 1px #600;\n        }\n        const opacity = DEFAULT_BACKGROUND_COLOR_OPACITY;\n        // tslint:disable-next-line:max-line-length\n        highlightArea.setAttribute(\"style\", `background-color: rgba(${highlight.color.red}, ${highlight.color.green}, ${highlight.color.blue}, ${opacity}) !important; ${extra}`);\n        // tslint:disable-next-line:max-line-length\n        // highlightArea.setAttribute(\"style\", `outline-color: magenta; outline-style: solid; outline-width: 1px; outline-offset: -1px;`);\n        highlightArea.style.setProperty(\"pointer-events\", \"none\");\n        highlightArea.style.position = paginated ? \"fixed\" : \"absolute\";\n        highlightArea.scale = scale;\n        // highlightArea.xOffset = xOffset;\n        // highlightArea.yOffset = yOffset;\n        highlightArea.rect = {\n            height: clientRect.height,\n            left: clientRect.left - xOffset,\n            top: clientRect.top - yOffset,\n            width: clientRect.width,\n        };\n        highlightArea.style.width = `${highlightArea.rect.width * scale}px`;\n        highlightArea.style.height = `${highlightArea.rect.height * scale}px`;\n        highlightArea.style.left = `${highlightArea.rect.left * scale}px`;\n        highlightArea.style.top = `${highlightArea.rect.top * scale}px`;\n\n        // if (highlight.pointerInteraction) {\n        //     highlightArea.style.setProperty(\"pointer-events\", \"auto\");\n        // }\n\n        highlightParent.append(highlightArea);\n    }\n\n    const rangeBoundingClientRect = range.getBoundingClientRect();\n    const highlightBounding = documant.createElement(\"div\") as IHTMLDivElementWithRect;\n    highlightBounding.setAttribute(\"class\", CLASS_HIGHLIGHT_BOUNDING_AREA);\n    if (win.READIUM2.DEBUG_VISUALS) {\n        // tslint:disable-next-line:max-line-length\n        highlightBounding.setAttribute(\"style\", `outline-color: magenta; outline-style: solid; outline-width: 1px; outline-offset: -1px;`);\n    }\n    highlightBounding.style.setProperty(\"pointer-events\", \"none\");\n    highlightBounding.style.position = paginated ? \"fixed\" : \"absolute\";\n    highlightBounding.scale = scale;\n    // highlightBounding.xOffset = xOffset;\n    // highlightBounding.yOffset = yOffset;\n    highlightBounding.rect = {\n        height: rangeBoundingClientRect.height,\n        left: rangeBoundingClientRect.left - xOffset,\n        top: rangeBoundingClientRect.top - yOffset,\n        width: rangeBoundingClientRect.width,\n    };\n    highlightBounding.style.width = `${highlightBounding.rect.width * scale}px`;\n    highlightBounding.style.height = `${highlightBounding.rect.height * scale}px`;\n    highlightBounding.style.left = `${highlightBounding.rect.left * scale}px`;\n    highlightBounding.style.top = `${highlightBounding.rect.top * scale}px`;\n    highlightParent.append(highlightBounding);\n\n    highlightsContainer.append(highlightParent);\n    return highlightParent;\n}\n"]}