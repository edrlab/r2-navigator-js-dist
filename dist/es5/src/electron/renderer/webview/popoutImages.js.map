{"version":3,"file":"popoutImages.js","sourceRoot":"","sources":["../../../../../../src/electron/renderer/webview/popoutImages.ts"],"names":[],"mappings":"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","sourcesContent":["// ==LICENSE-BEGIN==\n// Copyright 2017 European Digital Reading Lab. All rights reserved.\n// Licensed to the Readium Foundation under one or more contributor license agreements.\n// Use of this source code is governed by a BSD-style license\n// that can be found in the LICENSE file exposed on Github (readium) in the project repository.\n// ==LICENSE-END==\n\nimport {\n    CSS_CLASS_NO_FOCUS_OUTLINE, POPOUTIMAGE_CONTAINER_ID, POPOUTIMAGE_CONTROLS_ID, POPOUTIMAGE_CLOSE_ID, POPOUTIMAGE_MINUS_ID, POPOUTIMAGE_PLUS_ID, POPOUTIMAGE_RESET_ID, TTS_POPUP_DIALOG_CLASS,\n} from \"../../common/styles\";\nimport { PopupDialog, closePopupDialogs } from \"../common/popup-dialog\";\nimport { ReadiumElectronWebviewWindow } from \"./state\";\n\nexport function popoutImage(\n    win: ReadiumElectronWebviewWindow,\n    element: HTMLImageElement | SVGElement,\n    href_src: string,\n    focusScrollRaw:\n        (el: HTMLOrSVGElement, doFocus: boolean, animate: boolean, domRect: DOMRect | undefined) => void,\n    ensureTwoPageSpreadWithOddColumnsIsOffsetTempDisable: () => number,\n    ensureTwoPageSpreadWithOddColumnsIsOffsetReEnable: (val: number) => void,\n) {\n    // https://github.com/jackmoore/wheelzoom/blob/05224659740eea775a779faa62cef0ec0126082/wheelzoom.js\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (win as any).wheelzoom = (img: HTMLImageElement) => {\n        const zoomStep = 0.10;\n        const panStep = 20;\n\n        let viewportWidth = 0;\n        let viewportHeight = 0;\n        let naturalWidth = 0;\n        let naturalHeight = 0;\n        let containedWidth = 0;\n        let containedHeight = 0;\n\n        let bgWidth = 0;\n        let bgHeight = 0;\n        let bgPosX = 0;\n        let bgPosY = 0;\n\n        let touchHypot = 0;\n\n        let previousEvent: MouseEvent | undefined;\n        let previousEventTouch: TouchEvent | undefined;\n\n        function updateBgStyle() {\n            // if (bgPosX > 0) {\n            //     bgPosX = 0;\n            // } else if (bgPosX < width - bgWidth) {\n            //     bgPosX = width - bgWidth;\n            // }\n\n            // if (bgPosY > 0) {\n            //     bgPosY = 0;\n            // } else if (bgPosY < height - bgHeight) {\n            //     bgPosY = height - bgHeight;\n            // }\n\n            img.style.backgroundSize = bgWidth + \"px \" + bgHeight + \"px\";\n            img.style.backgroundPosition = bgPosX + \"px \" + bgPosY + \"px\";\n        }\n\n        function ontouch(e: TouchEvent) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            if (e.targetTouches.length !== 2) {\n                return;\n            }\n\n            const pageX1 = e.targetTouches[0].pageX;\n            const pageY1 = e.targetTouches[0].pageY;\n\n            const pageX2 = e.targetTouches[1].pageX;\n            const pageY2 = e.targetTouches[1].pageY;\n\n            // Math.hypot()\n            const touchHypot_ = Math.round(Math.sqrt(Math.pow(Math.abs(pageX1 - pageX2), 2) + Math.pow(Math.abs(pageY1 - pageY2), 2)));\n\n            let direction = 0;\n            if (touchHypot_ > touchHypot + 5) direction = -1;\n            if (touchHypot_ < touchHypot - 5) direction = 1;\n\n            if (direction !== 0) {\n                if (touchHypot || direction === 1) {\n\n                    const pageX = Math.min(pageX1, pageX2) + (Math.abs(pageX1 - pageX2) / 2);\n                    const pageY = Math.min(pageY1, pageY2) + (Math.abs(pageY1 - pageY2) / 2);\n\n                    const rect = img.getBoundingClientRect();\n                    const offsetX = pageX - rect.left - win.pageXOffset;\n                    const offsetY = pageY - rect.top - win.pageYOffset;\n\n                    const bgCursorX = offsetX - bgPosX;\n                    const bgCursorY = offsetY - bgPosY;\n\n                    const bgRatioX = bgCursorX / bgWidth;\n                    const bgRatioY = bgCursorY / bgHeight;\n\n                    if (direction < 0) {\n                        bgWidth += bgWidth * zoomStep;\n                        bgHeight += bgHeight * zoomStep;\n                    } else {\n                        bgWidth -= bgWidth * zoomStep;\n                        bgHeight -= bgHeight * zoomStep;\n                    }\n\n                    bgPosX = offsetX - (bgWidth * bgRatioX);\n                    bgPosY = offsetY - (bgHeight * bgRatioY);\n\n                    updateBgStyle();\n                }\n\n                touchHypot = touchHypot_;\n            }\n        }\n\n        function onwheel(e: WheelEvent) {\n            e.preventDefault();\n            e.stopPropagation();\n\n            const rect = img.getBoundingClientRect();\n            const offsetX = e.pageX - rect.left - win.pageXOffset;\n            const offsetY = e.pageY - rect.top - win.pageYOffset;\n\n            const bgCursorX = offsetX - bgPosX;\n            const bgCursorY = offsetY - bgPosY;\n\n            const bgRatioX = bgCursorX / bgWidth;\n            const bgRatioY = bgCursorY / bgHeight;\n\n            if (e.deltaY < 0) {\n                bgWidth += bgWidth * zoomStep;\n                bgHeight += bgHeight * zoomStep;\n            } else {\n                bgWidth -= bgWidth * zoomStep;\n                bgHeight -= bgHeight * zoomStep;\n            }\n\n            bgPosX = offsetX - (bgWidth * bgRatioX);\n            bgPosY = offsetY - (bgHeight * bgRatioY);\n\n            updateBgStyle();\n        }\n\n        // let clickDownUpHasMovedTouch = false;\n        function dragtouch(e: TouchEvent) {\n            if (e.targetTouches.length !== 1) {\n                return;\n            }\n            // clickDownUpHasMovedTouch = true;\n            e.preventDefault();\n            const pageX = e.targetTouches[0].clientX;\n            const pageY = e.targetTouches[0].clientY;\n            bgPosX += (pageX - (previousEventTouch?.targetTouches[0].clientX || 0));\n            bgPosY += (pageY - (previousEventTouch?.targetTouches[0].clientY || 0));\n            previousEventTouch = e;\n            updateBgStyle();\n        }\n\n        function removeDragtouch(e: TouchEvent) {\n            if (e.targetTouches.length !== 1) {\n                return;\n            }\n            // clickDownUpHasMovedTouch = false;\n            e.preventDefault();\n            e.stopPropagation();\n            previousEventTouch = undefined;\n            img.removeEventListener(\"touchend\", removeDragtouch);\n            img.removeEventListener(\"touchmove\", dragtouch);\n        }\n\n        function draggabletouch(e: TouchEvent) {\n            if (e.targetTouches.length !== 1) {\n                return;\n            }\n            // clickDownUpHasMovedTouch = false;\n            e.preventDefault();\n            previousEventTouch = e;\n            img.addEventListener(\"touchmove\", dragtouch);\n            img.addEventListener(\"touchend\", removeDragtouch);\n        }\n\n        let clickDownUpHasMoved = false;\n        function drag(e: MouseEvent) {\n            clickDownUpHasMoved = true;\n            e.preventDefault();\n            bgPosX += (e.pageX - (previousEvent?.pageX || 0));\n            bgPosY += (e.pageY - (previousEvent?.pageY || 0));\n            previousEvent = e;\n            updateBgStyle();\n        }\n\n        function removeDrag(e: MouseEvent) {\n            // clickDownUpHasMoved = false;\n            e.preventDefault();\n            e.stopPropagation();\n            previousEvent = undefined;\n            document.removeEventListener(\"mouseup\", removeDrag);\n            document.removeEventListener(\"mouseleave\", removeDrag);\n            document.removeEventListener(\"mousemove\", drag);\n        }\n\n        function draggable(e: MouseEvent) {\n            clickDownUpHasMoved = false;\n            e.preventDefault();\n            previousEvent = e;\n            document.addEventListener(\"mousemove\", drag);\n            document.addEventListener(\"mouseup\", removeDrag);\n            document.addEventListener(\"mouseleave\", removeDrag);\n        }\n\n        function onclick(e: MouseEvent | undefined, force?: boolean) {\n            if (!force && (previousEvent || clickDownUpHasMoved)) {\n                return;\n            }\n            if (e) {\n                e.preventDefault();\n                e.stopPropagation();\n            }\n\n            const initialZoom = 1;\n            bgWidth = containedWidth * initialZoom;\n            bgHeight = containedHeight * initialZoom;\n            bgPosX = -(bgWidth - viewportWidth) * 0.5;\n            bgPosY = -(bgHeight - viewportHeight) * 0.5;\n\n            updateBgStyle();\n        }\n\n        function reset() {\n            const computedStyle = win.getComputedStyle(img, null);\n            viewportWidth = parseInt(computedStyle.width, 10);\n            viewportHeight = parseInt(computedStyle.height, 10);\n\n            const hRatio = naturalHeight / viewportHeight;\n            const wRatio = naturalWidth / viewportWidth;\n\n            containedWidth = viewportWidth;\n            containedHeight = viewportHeight;\n            if (hRatio > wRatio) {\n                containedWidth = naturalWidth / hRatio;\n            } else if (hRatio < wRatio) {\n                containedHeight = naturalHeight / wRatio;\n            }\n        }\n\n        function init() {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if ((img as any).__INITED) {\n                return;\n            }\n\n            win.READIUM2.ignorekeyDownUpEvents = true;\n\n            naturalHeight = img.naturalHeight;\n            naturalWidth = img.naturalWidth;\n\n            reset();\n\n            img.style.backgroundRepeat = \"no-repeat\";\n            img.style.backgroundImage = \"url(\\\"\" + img.src + \"\\\")\";\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            (img as any).__INITED = true;\n\n            img.src = \"data:image/svg+xml;base64,\" + Buffer.from(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"\" + naturalWidth + \"\\\" height=\\\"\" + naturalHeight + \"\\\"></svg>\").toString(\"base64\");\n\n            onclick(undefined, true);\n\n            img.addEventListener(\"wheel\", onwheel);\n            img.addEventListener(\"touchmove\", ontouch);\n            img.addEventListener(\"touchstart\", draggabletouch);\n            img.addEventListener(\"mousedown\", draggable);\n            img.addEventListener(\"click\", onclick);\n\n            const resizeObserver = new win.ResizeObserver((_entries) => {\n                reset();\n                onclick(undefined, true);\n            });\n            resizeObserver.observe(img);\n            // img.addEventListener(\"resize\", () => {\n            //     reset();\n            //     onclick(undefined, true);\n            // });\n\n            (win.document.getElementById(POPOUTIMAGE_CLOSE_ID) as HTMLElement).focus();\n            (win.document.getElementById(POPOUTIMAGE_CLOSE_ID) as HTMLElement).addEventListener(\"click\", () => {\n                closePopupDialogs(win.document);\n            });\n            (win.document.getElementById(POPOUTIMAGE_RESET_ID) as HTMLElement).addEventListener(\"click\", () => {\n                onclick(undefined, true);\n            });\n            const panLeft = (fast: boolean) => {\n                bgPosX -= panStep * (fast ? 2 : 1);\n\n                updateBgStyle();\n            };\n            const panRight = (fast: boolean) => {\n                bgPosX += panStep * (fast ? 2 : 1);\n\n                updateBgStyle();\n            };\n            const panUp = (fast: boolean) => {\n                bgPosY -= panStep * (fast ? 2 : 1);\n\n                updateBgStyle();\n            };\n            const panDown = (fast: boolean) => {\n                bgPosY += panStep * (fast ? 2 : 1);\n\n                updateBgStyle();\n            };\n            const minus = () => {\n                // bgWidth -= bgWidth * zoomStep;\n                // bgHeight -= bgHeight * zoomStep;\n\n                const offsetX = viewportWidth / 2;\n                const offsetY = viewportHeight / 2;\n\n                const bgCursorX = offsetX - bgPosX;\n                const bgCursorY = offsetY - bgPosY;\n\n                const bgRatioX = bgCursorX / bgWidth;\n                const bgRatioY = bgCursorY / bgHeight;\n\n                bgWidth -= bgWidth * zoomStep;\n                bgHeight -= bgHeight * zoomStep;\n\n                bgPosX = offsetX - (bgWidth * bgRatioX);\n                bgPosY = offsetY - (bgHeight * bgRatioY);\n\n                updateBgStyle();\n            };\n            (win.document.getElementById(POPOUTIMAGE_MINUS_ID) as HTMLElement).addEventListener(\"click\", minus);\n            const plus = () => {\n                // bgWidth += bgWidth * zoomStep;\n                // bgHeight += bgHeight * zoomStep;\n\n                const offsetX = viewportWidth / 2;\n                const offsetY = viewportHeight / 2;\n\n                const bgCursorX = offsetX - bgPosX;\n                const bgCursorY = offsetY - bgPosY;\n\n                const bgRatioX = bgCursorX / bgWidth;\n                const bgRatioY = bgCursorY / bgHeight;\n\n                bgWidth += bgWidth * zoomStep;\n                bgHeight += bgHeight * zoomStep;\n\n                bgPosX = offsetX - (bgWidth * bgRatioX);\n                bgPosY = offsetY - (bgHeight * bgRatioY);\n\n                updateBgStyle();\n            };\n            (win.document.getElementById(POPOUTIMAGE_PLUS_ID) as HTMLElement).addEventListener(\"click\", plus);\n\n            function keyDownUpEventHandler(ev: KeyboardEvent, _keyDown: boolean) {\n                // altKey: ev.altKey,\n                // code: ev.code,\n                // ctrlKey: ev.ctrlKey,\n                // key: ev.key,\n                // metaKey: ev.metaKey,\n                // shiftKey: ev.shiftKey,\n\n                let handled = false;\n                if (ev.keyCode === 37) { // left\n                    handled = true;\n                    panLeft(ev.ctrlKey);\n                } else if (ev.keyCode === 39) { // right\n                    handled = true;\n                    panRight(ev.ctrlKey);\n                } else if (ev.keyCode === 38) { // up\n                    handled = true;\n                    panUp(ev.ctrlKey);\n                } else if (ev.keyCode === 40) { // down\n                    handled = true;\n                    panDown(ev.ctrlKey);\n                } else if (ev.ctrlKey && ev.code === \"Minus\") {\n                    handled = true;\n                    minus();\n                } else if (ev.ctrlKey && ev.code === \"Plus\") {\n                    handled = true;\n                    plus();\n                } else if (ev.ctrlKey && (ev.code === \"Digit0\" || ev.code === \"Digit1\" || ev.code === \"Backspace\" || ev.code === \"Equal\")) {\n                    handled = true;\n                    reset();\n                }\n                if (handled) {\n                    ev.preventDefault();\n                    ev.stopPropagation();\n                }\n            }\n            (win.document.getElementById(POPOUTIMAGE_CONTAINER_ID) as HTMLElement).addEventListener(\"keydown\", (ev: KeyboardEvent) => {\n                keyDownUpEventHandler(ev, true);\n            }, {\n                capture: true,\n                once: false,\n                passive: false,\n            });\n            // (win.document.getElementById(POPOUTIMAGE_CONTAINER_ID) as HTMLElement).addEventListener(\"keyup\", (ev: KeyboardEvent) => {\n            //     keyDownUpEventHandler(ev, false);\n            // }, {\n            //     capture: true,\n            //     once: false,\n            //     passive: false,\n            // });\n        }\n        init();\n        // if (img.complete) {\n        //     init();\n        // }\n        // img.addEventListener(\"load\", init);\n    };\n\n    // const documant = win.document || element.ownerDocument as Document;\n    // if (!documant.documentElement\n    //     || documant.documentElement.classList.contains(ROOT_CLASS_NO_POPOUTIMAGES)\n    // ) {\n    //     return false;\n    // }\n\n    const isSVG = href_src.startsWith(\"<svg\");\n    if (isSVG) {\n        // href_src = href_src.replace(/\\n/g, \" \").replace(/\\s\\s+/g, \" \").trim();\n        href_src = \"data:image/svg+xml;base64,\" + Buffer.from(href_src).toString(\"base64\");\n    }\n\n    const onloadhandler = \"onload=\\\"javascript: \" +\n        \"window.wheelzoom(this);\" +\n        \"return; \\\"\";\n\n    // tslint:disable-next-line:max-line-length\n    const htmltxt = `\n<div\n    class=\"${CSS_CLASS_NO_FOCUS_OUTLINE}\"\n    tabindex=\"0\"\n    autofocus=\"autofocus\"\n    id=\"${POPOUTIMAGE_CONTAINER_ID}\"\n    >\n    <img\n        class=\"${POPOUTIMAGE_CONTAINER_ID}\"\n        ${onloadhandler}\n        src=\"${href_src}\"\n    />\n    <div id=\"${POPOUTIMAGE_CONTROLS_ID}\">\n    <button id=\"${POPOUTIMAGE_MINUS_ID}\">-</button>\n    <button id=\"${POPOUTIMAGE_RESET_ID}\" title=\"0\">O</button>\n    <button id=\"${POPOUTIMAGE_PLUS_ID}\">+</button>\n    </div>\n    <button id=\"${POPOUTIMAGE_CLOSE_ID}\">X</button>\n</div>`;\n\n    // ${win.document.documentElement.classList.contains(ROOT_CLASS_FIXED_LAYOUT) ?\n    //     \"style=\\\"transform-origin: 0px 0px;transform: scale(var(--r2_fxl_scale));\\\"\" :\n    //     \"\"}\n\n    const val = ensureTwoPageSpreadWithOddColumnsIsOffsetTempDisable();\n\n    // HACKY!\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    // if (!(win as any).readiumClosePopupDialogs) {\n    //     // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    //     (win as any).readiumClosePopupDialogs = () => { closePopupDialogs(win.document); };\n    // }\n\n    function onDialogClosed(el: HTMLOrSVGElement | null) {\n        win.READIUM2.ignorekeyDownUpEvents = false;\n\n        if (el) {\n            focusScrollRaw(el, true, true, undefined);\n        } else {\n            ensureTwoPageSpreadWithOddColumnsIsOffsetReEnable(val);\n        }\n\n        setTimeout(() => {\n            pop.dialog.remove();\n        }, 50);\n    }\n    const pop = new PopupDialog(element.ownerDocument as Document, htmltxt, onDialogClosed, TTS_POPUP_DIALOG_CLASS, false);\n    pop.show(element);\n}\n"]}