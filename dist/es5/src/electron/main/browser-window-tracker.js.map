{"version":3,"file":"browser-window-tracker.js","sourceRoot":"","sources":["../../../../../src/electron/main/browser-window-tracker.ts"],"names":[],"mappings":";;AAAA,qCAA+B;AAE/B,2CAAiD;AAEjD,IAAI,uBAAiD,CAAC;AAEtD,4BAAmC,GAA2B;IAE1D,EAAE,CAAC,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAC;QAC3B,uBAAuB,GAAG,EAAE,CAAC;IACjC,CAAC;IACD,uBAAuB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAElC,GAAG,CAAC,EAAE,CAAC,QAAQ,EAAE;QACb,IAAM,CAAC,GAAG,uBAAuB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC/C,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACR,MAAM,CAAC;QACX,CAAC;QACD,uBAAuB,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IACzC,CAAC,CAAC,CAAC;AACP,CAAC;AAdD,gDAcC;AAED,cAAG,CAAC,EAAE,CAAC,sBAAsB,EAAE,UAAC,IAAI,EAAE,EAAE;IACpC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;QACtB,MAAM,CAAC;IACX,CAAC;IAED,EAAE,CAAC,CAAC,CAAC,uBAAuB,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC,CAAC;QAC9D,MAAM,CAAC;IACX,CAAC;IACD,uBAAuB,CAAC,OAAO,CAAC,UAAC,GAAG;QAChC,EAAE,CAAC,CAAC,EAAE,CAAC,eAAe,CAAC,EAAE,KAAK,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC;YAC/C,OAAO,CAAC,GAAG,CAAC,8BAA8B,CAAC,CAAC;YAE5C,EAAE,CAAC,EAAE,CAAC,eAAe,EAAE,UAAC,KAAK,EAAE,GAAG;gBAC9B,OAAO,CAAC,GAAG,CAAC,6CAA6C,CAAC,CAAC;gBAG3D,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;gBAEjB,IAAM,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;gBACpC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;gBAEnB,KAAK,CAAC,cAAc,EAAE,CAAC;gBAGvB,GAAG,CAAC,WAAW,CAAC,IAAI,CAAC,sBAAa,EAAE,GAAG,CAAC,CAAC;YAC7C,CAAC,CAAC,CAAC;QACP,CAAC;IACL,CAAC,CAAC,CAAC;AACP,CAAC,CAAC,CAAC","sourcesContent":["import { app } from \"electron\";\r\n\r\nimport { R2_EVENT_LINK } from \"../common/events\";\r\n\r\nlet _electronBrowserWindows: Electron.BrowserWindow[];\r\n\r\nexport function trackBrowserWindow(win: Electron.BrowserWindow) {\r\n\r\n    if (!_electronBrowserWindows) {\r\n        _electronBrowserWindows = [];\r\n    }\r\n    _electronBrowserWindows.push(win);\r\n\r\n    win.on(\"closed\", () => {\r\n        const i = _electronBrowserWindows.indexOf(win);\r\n        if (i < 0) {\r\n            return;\r\n        }\r\n        _electronBrowserWindows.splice(i, 1);\r\n    });\r\n}\r\n\r\napp.on(\"web-contents-created\", (_evt, wc) => {\r\n    if (!wc.hostWebContents) {\r\n        return;\r\n    }\r\n\r\n    if (!_electronBrowserWindows || !_electronBrowserWindows.length) {\r\n        return;\r\n    }\r\n    _electronBrowserWindows.forEach((win) => {\r\n        if (wc.hostWebContents.id === win.webContents.id) {\r\n            console.log(\"WEBVIEW web-contents-created\");\r\n\r\n            wc.on(\"will-navigate\", (event, url) => {\r\n                console.log(\"webview.getWebContents().on('will-navigate'\");\r\n\r\n                // console.log(event.sender);\r\n                console.log(url);\r\n\r\n                const wcUrl = event.sender.getURL();\r\n                console.log(wcUrl);\r\n\r\n                event.preventDefault();\r\n\r\n                // ipcMain.emit\r\n                win.webContents.send(R2_EVENT_LINK, url);\r\n            });\r\n        }\r\n    });\r\n});\r\n"]}